<form id='ai_scan_qa_job' platforms='web' dashboard='false' menuName='QA_Job' title='' menuOrder='hidden' style='{styles.sylFormUserManagement}' xmlns='http://schemas.mobilengine.com/fls/v2'>
    <declarations>
        <let id='stSelectedQAJobId' shape='scalar' access='private' value='{SELECT params.QAJobId}'/>
        <let id='stSelectedQAJobDeliveryId' shape='scalar' access='private' value='{SELECT DNJ.id FROM ai_scan_delivery_note_job DNJ WHERE DNJ.job_id = stSelectedQAJobId}'/>
        <let id='stSelectedQAJobDeliveryNoteId' shape='scalar' access='private' value='{SELECT DNJ.delivery_note_id FROM ai_scan_delivery_note_job DNJ WHERE DNJ.job_id = stSelectedQAJobId}'/>
        <let id='stSelectedQAJobSupplierId' shape='scalar' access='private' value='{SELECT DNJ.supplier_id FROM ai_scan_delivery_note_job DNJ WHERE DNJ.job_id = stSelectedQAJobId}'/>
        <let id='stSelectedQAJobSupplierPdfFileref' shape='scalar' access='private' value='{SELECT DNJ.fileref_pdf FROM ai_scan_delivery_note_job DNJ WHERE DNJ.job_id = stSelectedQAJobId}'/>
        <let id='ltblSelectedQAJobAnotJobs' shape='table' access='private' 
            value='{SELECT 
                        DNJ.job_id
                    FROM
                        ai_scan_delivery_note_job DNJ
                    WHERE
                        DNJ.id = stSelectedQAJobDeliveryId
                        AND DNJ.delivery_note_id = stSelectedQAJobDeliveryNoteId
                        AND DNJ.job_id != stSelectedQAJobId
                        }'
        />
        <let id='stSelectedQAJobAnotJobsConcat' shape='scalar' access='private' value='{SELECT GROUP_CONCAT(SQAJAJ.job_id) FROM ltblSelectedQAJobAnotJobs SQAJAJ}'/>
        <let id='stSelectedQAJobAnotJobsAgentA' shape='scalar' access='private' value='{SUBSTR(stSelectedQAJobAnotJobsConcat, 0, INSTR(stSelectedQAJobAnotJobsConcat, ","))}'/>
        <let id='stSelectedQAJobAnotJobsAgentB' shape='scalar' access='private' value='{SUBSTR(stSelectedQAJobAnotJobsConcat, INSTR(stSelectedQAJobAnotJobsConcat, ",") + 1, LENGTH(stSelectedQAJobAnotJobsConcat))}'/>
        <let id='ltblSelectedQAJobAgentAResult' shape='table' access='private' 
			value='{SELECT
                        JR.result,
                        DNJ.customer_address,
                        DNJ.customer_name,
                        DNJ.delivery_address,
                        DNJ.delivery_recipient_name,
                        DNJ.issue_date,
                        DNJ.order_number,
                        DNJ.supplier_address,
                        DNJ.supplier_name,
                        DNJ.supplier_tax_number,
                        DNJ.supplier_warehouse,
                        DNJ.supplier_id,
                        DNJ.weight_gross
					FROM
                        ai_scan_job_result JR
                    LEFT JOIN 
                        ai_scan_jobs J ON J.id = JR.job_id
                    LEFT JOIN 
                        ai_scan_delivery_note_job DNJ ON DNJ.job_id = JR.job_id
					WHERE
                        JR.job_id = stSelectedQAJobAnotJobsAgentA
                    }'
		/>
        <let id='stSelectedQAJobAnotJobsAgentAResultStatus' shape='scalar' access='private' value='{SELECT SQAJAAR.result FROM ltblSelectedQAJobAgentAResult SQAJAAR}'/>
        <let id='ltblSelectedQAJobAgentBResult' shape='table' access='private' 
			value='{SELECT
                        JR.result,
                        DNJ.customer_address,
                        DNJ.customer_name,
                        DNJ.delivery_address,
                        DNJ.delivery_recipient_name,
                        DNJ.issue_date,
                        DNJ.order_number,
                        DNJ.supplier_address,
                        DNJ.supplier_name,
                        DNJ.supplier_tax_number,
                        DNJ.supplier_warehouse,
                        DNJ.supplier_id,
                        DNJ.weight_gross
					FROM
                        ai_scan_job_result JR
                    LEFT JOIN 
                        ai_scan_jobs J ON J.id = JR.job_id
                    LEFT JOIN 
                        ai_scan_delivery_note_job DNJ ON DNJ.job_id = JR.job_id
					WHERE
                        JR.job_id = stSelectedQAJobAnotJobsAgentB
                    }'
		/>
        <let id='stSelectedQAJobAnotJobsAgentBResultStatus' shape='scalar' access='private' value='{SELECT SQAJABR.result FROM ltblSelectedQAJobAgentBResult SQAJABR}'/>
    </declarations>
    <header></header>
    <params>
		<param id='QAJobId'/>	
	</params>
    <textview id='tvTitle' text='{CASE WHEN stSelectedQAJobSupplierId = "" OR stSelectedQAJobSupplierId = null THEN "Delivery note number not available" ELSE stSelectedQAJobSupplierId END }' style='{styles.sylTvQATitle}' testId='tvTitle'/>
    <textview id='tvErrorsCounter' text='{"Total corrections: Teszt"}' style='{styles.sylTvQAErrorsCounter}' testId='tvErrorsCounter'/>
    <hbox style='{styles.sylQAMainHeaderAndButtonHbox}'>
        <vbox style='{styles.sylQAMainHeaderAndButtonHboxVbox}'>
            <block>
                <hbox style='{styles.sylQAMainHeaderHbox}'>
                    <textview id='tvEmpty' text='{""}' testId='tvEmpty'/>
                    <textview id='tvAgentA' text='{CASE WHEN stSelectedQAJobAnotJobsAgentAResultStatus = "REJECTED" THEN "REJECTED AGENT A" ELSE "AGENT A" END}' testId='tvAgentA'/>
                    <textview id='tvAgentB' text='{CASE WHEN stSelectedQAJobAnotJobsAgentBResultStatus = "REJECTED" THEN "REJECTED AGENT B" ELSE "AGENT B" END}' testId='tvAgentB'/>
                </hbox>
            </block>
        </vbox>
        <vbox style='{styles.sylQAMainHeaderAndButtonHboxVbox}'>
            <block>
                <hbox style='{styles.sylQAMainButtonHbox}'>
                    <textview id='tvErrorsNumber2222' text='{"1"}' testId='tvErrorsNumber'/>
                    <textview id='tvErrorsNumber3333' text='{"2"}' testId='tvErrorsNumber'/>
                    <textview id='tvErrorsNumber4444' text='{"3"}' testId='tvErrorsNumber'/>
                    <textview id='tvErrorsNumber5555' text='{"4"}' testId='tvErrorsNumber'/>
                    <textview id='tvErrorsNumber6666' text='{""}' testId='tvErrorsNumber'/>
                </hbox>
            </block>
        </vbox>
    </hbox>
    <hbox style='{styles.sylQAMainDeliveryNoteQAAndPdfAnnotatorHbox}'>
        <vbox style='{styles.sylQAMainDeliveryNoteQAAndPdfAnnotatorVbox}'>
            <block>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvCustomerAddress' text='{"customer_address"}' testId='tvCustomerAddress'/>
                    <textview id='tvCustomerAddressA' text='{SELECT SQAJAAR.customer_address FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvCustomerAddressA'/>
                    <textview id='tvCustomerAddressB' text='{SELECT SQAJABR.customer_address FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvCustomerAddressB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvCustomerName' text='{"customer_name"}' testId='tvCustomerName'/>
                    <textview id='tvCustomerNameA' text='{SELECT SQAJAAR.customer_name FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvCustomerNameA'/>
                    <textview id='tvCustomerNameB' text='{SELECT SQAJABR.customer_name FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvCustomerNameB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvDeliveryAddress' text='{"delivery_address"}' testId='tvDeliveryAddress'/>
                    <textview id='tvDeliveryAddressA' text='{SELECT SQAJAAR.delivery_address FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvDeliveryAddressA'/>
                    <textview id='tvDeliveryAddressB' text='{SELECT SQAJABR.delivery_address FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvDeliveryAddressB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvDeliveryRecipientName' text='{"delivery_recipient_name"}' testId='tvDeliveryRecipientName'/>
                    <textview id='tvDeliveryRecipientNameA' text='{SELECT SQAJAAR.delivery_recipient_name FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvDeliveryRecipientNameA'/>
                    <textview id='tvDeliveryRecipientNameB' text='{SELECT SQAJABR.delivery_recipient_name FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvDeliveryRecipientNameB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvIssueDate' text='{"issue_date"}' testId='tvIssueDate'/>
                    <textview id='tvIssueDateA' text='{SELECT SQAJAAR.issue_date FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvIssueDateA'/>
                    <textview id='tvIssueDateB' text='{SELECT SQAJABR.issue_date FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvIssueDateB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvOrderNumber' text='{"order_number"}' testId='tvOrderNumber'/>
                    <textview id='tvOrderNumberA' text='{SELECT SQAJAAR.order_number FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvOrderNumberA'/>
                    <textview id='tvOrderNumberB' text='{SELECT SQAJABR.order_number FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvOrderNumberB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvSupplierAddress' text='{"supplier_address"}' testId='tvSupplierAddress'/>
                    <textview id='tvSupplierAddressA' text='{SELECT SQAJAAR.supplier_address FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvSupplierAddressA'/>
                    <textview id='tvSupplierAddressB' text='{SELECT SQAJABR.supplier_address FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvSupplierAddressB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvSupplierName' text='{"supplier_name"}' testId='tvSupplierName'/>
                    <textview id='tvSupplierNameA' text='{SELECT SQAJAAR.supplier_name FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvSupplierNameA'/>
                    <textview id='tvSupplierNameB' text='{SELECT SQAJABR.supplier_name FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvSupplierNameB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvSupplierTaxNumber' text='{"supplier_tax_number"}' testId='tvSupplierTaxNumber'/>
                    <textview id='tvSupplierTaxNumberA' text='{SELECT SQAJAAR.supplier_tax_number FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvSupplierTaxNumberA'/>
                    <textview id='tvSupplierTaxNumberB' text='{SELECT SQAJABR.supplier_tax_number FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvSupplierTaxNumberB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvSupplierWarehouse' text='{"supplier_warehouse"}' testId='tvSupplierWarehouse'/>
                    <textview id='tvSupplierWarehouseA' text='{SELECT SQAJAAR.supplier_warehouse FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvSupplierWarehouseA'/>
                    <textview id='tvSupplierWarehouseB' text='{SELECT SQAJABR.supplier_warehouse FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvSupplierWarehouseB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvSupplierId' text='{"supplier_id"}' testId='tvSupplierId'/>
                    <textview id='tvSupplierIdA' text='{SELECT SQAJAAR.supplier_id FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvSupplierIdA'/>
                    <textview id='tvSupplierIdB' text='{SELECT SQAJABR.supplier_id FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvSupplierIdB'/>
                </hbox>
                <hbox style='{styles.sylQAMainDeliveryNoteQAHbox}'>
                    <textview id='tvWeightGross' text='{"weight_gross"}' testId='tvWeightGross'/>
                    <textview id='tvWeightGrossA' text='{SELECT SQAJAAR.weight_gross FROM ltblSelectedQAJobAgentAResult SQAJAAR}' testId='tvWeightGrossA'/>
                    <textview id='tvWeightGrossB' text='{SELECT SQAJABR.weight_gross FROM ltblSelectedQAJobAgentBResult SQAJABR}' testId='tvWeightGrossB'/>
                </hbox>
            </block>
        </vbox>
        <vbox style='{styles.sylQAMainDeliveryNoteQAAndPdfAnnotatorVbox}'>
            <annotator id='annotator' text='' 
                exportFileName='{stSelectedQAJobSupplierId}' 
                style='{styles.sylPdfwebAnnotator}'
                fileref='{SELECT stSelectedQAJobSupplierPdfFileref}'
                allowNewPoint='{false}'
                allowSelection='{false}'
                openOnSet='{false}'
                testId='{"getAnnotator"}' 
            />
        </vbox>
    </hbox>
</form>